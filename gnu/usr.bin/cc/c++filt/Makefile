# $FreeBSD: src/gnu/usr.bin/cc/c++filt/Makefile,v 1.11 1999/11/04 04:45:59 obrien Exp $

.include "../Makefile.inc"

.PATH: ${GCCDIR}

PROG=	c++filt
SRCS=	cplus-dem.c getopt.c getopt1.c underscore.c
BINDIR=	/usr/libexec/${OBJFORMAT}
NOMAN=	1

CFLAGS+= -DMAIN -DIN_GCC -DVERSION=\"$(version)\"

CLEANFILES= tmp-dum.c tmp-dum.s underscore.c

underscore.c:
	echo "int xxy_us_dummy;" >tmp-dum.c
	${CC} -S tmp-dum.c
	echo '/*WARNING: This file is automatically generated!*/' >underscore.c
	if grep _xxy_us_dummy tmp-dum.s > /dev/null ; then \
	  echo "int prepends_underscore = 1;" >>underscore.c; \
	else \
	  echo "int prepends_underscore = 0;" >>underscore.c; \
	fi
	rm -f tmp-dum.c tmp-dum.s

.include <bsd.prog.mk>
